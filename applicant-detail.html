<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Applicant Details - AI Hiring Platform</title>
  <link rel="stylesheet" href="global.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <a href="landing.html" class="navbar-brand">AI Hiring</a>
      <ul class="navbar-nav">
        <li><a href="company-dashboard.html" class="navbar-link">My Jobs</a></li>
        <li><a href="#" onclick="logout()" class="navbar-link">Logout</a></li>
      </ul>
    </div>
  </nav>

  <!-- Applicant Detail Section -->
  <section class="dashboard">
    <div class="container-narrow">
      <!-- Back Button -->
      <div class="mb-3">
        <a href="view-job.html" class="btn btn-secondary btn-small">‚Üê Back to Applicants</a>
      </div>

      <!-- Alert Messages -->
      <div id="successMessage" class="alert alert-success hidden"></div>
      <div id="errorMessage" class="alert alert-error hidden"></div>

      <!-- Applicant Header Card -->
      <div class="card">
        <div class="card-header">
          <div class="flex justify-between items-center">
            <div>
              <h1 class="card-title" style="font-size: 1.75rem; margin-bottom: 0.5rem;">
                Sarah Johnson
              </h1>
              <p class="text-muted">sarah.johnson@email.com ‚Ä¢ +1 234 567 8900</p>
              <p class="text-small text-muted">Applied 1 day ago</p>
            </div>
            <span class="status-badge status-completed">Interview Completed</span>
          </div>
        </div>
        <div class="card-body">
          <!-- AI Scores -->
          <div class="flex gap-4 mb-4">
            <div style="text-align: center;">
              <p class="text-small text-muted">Resume Score</p>
              <p style="font-size: 3rem; font-weight: 700; color: #16a34a; line-height: 1; margin: 0.5rem 0;">92</p>
              <p class="text-small" style="color: #16a34a;">Excellent Match</p>
            </div>
            <div style="text-align: center;">
              <p class="text-small text-muted">Interview Score</p>
              <p style="font-size: 3rem; font-weight: 700; color: #16a34a; line-height: 1; margin: 0.5rem 0;">88</p>
              <p class="text-small" style="color: #16a34a;">Strong Performance</p>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex gap-2 flex-wrap">
            <button class="btn btn-success" onclick="shortlistApplicant()">
              ‚úì Shortlist Candidate
            </button>
            <button class="btn btn-danger" onclick="rejectApplicant()">
              ‚úï Reject
            </button>
            <button class="btn btn-outline" onclick="downloadResume()">
              üìÑ Download Resume
            </button>
            <button class="btn btn-outline" onclick="contactCandidate()">
              üìß Contact Candidate
            </button>
          </div>
        </div>
      </div>

      <!-- Applied For Job Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Applied For</h2>
        </div>
        <div class="card-body">
          <h3 style="font-size: 1.125rem; margin-bottom: 0.25rem;">Senior Software Engineer</h3>
          <p class="text-muted">Mountain View, CA ‚Ä¢ Full-time</p>
        </div>
      </div>

      <!-- Contact Information Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Contact Information</h2>
        </div>
        <div class="card-body">
          <div class="grid grid-2">
            <div>
              <p class="text-small text-muted">Email</p>
              <p class="text-bold">sarah.johnson@email.com</p>
            </div>
            <div>
              <p class="text-small text-muted">Phone</p>
              <p class="text-bold">+1 234 567 8900</p>
            </div>
            <div>
              <p class="text-small text-muted">WhatsApp</p>
              <p class="text-bold">+1 234 567 8900</p>
            </div>
            <div>
              <p class="text-small text-muted">Location</p>
              <p class="text-bold">San Francisco, CA</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Professional Summary Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Professional Summary</h2>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <p class="text-small text-muted">Experience</p>
            <p class="text-bold">7 years</p>
          </div>
          <div class="mb-3">
            <p class="text-small text-muted">Education</p>
            <p class="text-bold">Master's Degree in Computer Science</p>
            <p class="text-small">Stanford University ‚Ä¢ CGPA: 3.8/4.0</p>
          </div>
        </div>
      </div>

      <!-- AI Resume Analysis Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">AI Resume Analysis</h2>
          <span class="badge badge-success">Score: 92/100</span>
        </div>
        <div class="card-body">
          <!-- Strengths -->
          <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: #16a34a;">‚úì Strengths</h3>
          <ul style="padding-left: 1.5rem; margin-bottom: 1.5rem; color: #555;">
            <li style="margin-bottom: 0.5rem;">7+ years of experience with Python and Go</li>
            <li style="margin-bottom: 0.5rem;">Strong background in distributed systems and cloud infrastructure</li>
            <li style="margin-bottom: 0.5rem;">Experience at top tech companies (Google, Amazon)</li>
            <li style="margin-bottom: 0.5rem;">Relevant certifications: AWS Solutions Architect, CKA</li>
            <li style="margin-bottom: 0.5rem;">Master's degree from top university</li>
          </ul>

          <!-- Skills Match -->
          <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">Skills Match</h3>
          <div class="flex flex-wrap gap-1 mb-3">
            <span class="badge badge-success">Python ‚úì</span>
            <span class="badge badge-success">Go ‚úì</span>
            <span class="badge badge-success">Kubernetes ‚úì</span>
            <span class="badge badge-success">Docker ‚úì</span>
            <span class="badge badge-success">AWS ‚úì</span>
            <span class="badge badge-secondary">GraphQL</span>
            <span class="badge badge-secondary">React</span>
          </div>

          <!-- Areas for Development -->
          <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: #d97706;">‚ö† Areas to Explore</h3>
          <ul style="padding-left: 1.5rem; margin: 0; color: #555;">
            <li style="margin-bottom: 0.5rem;">Limited experience with Rust (mentioned as nice-to-have)</li>
            <li style="margin-bottom: 0.5rem;">No explicit mention of technical leadership roles</li>
          </ul>
        </div>
      </div>

      <!-- AI Interview Analysis Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">AI Interview Analysis</h2>
          <span class="badge badge-success">Score: 88/100</span>
        </div>
        <div class="card-body">
          <!-- Overall Assessment -->
          <div class="mb-4">
            <h3 style="font-size: 1rem; margin-bottom: 0.75rem;">Overall Assessment</h3>
            <p class="text-muted">
              Candidate demonstrated strong technical knowledge and problem-solving abilities. 
              Communication was clear and structured. Showed good understanding of system design 
              principles and practical experience with relevant technologies.
            </p>
          </div>

          <!-- Performance Breakdown -->
          <h3 style="font-size: 1rem; margin-bottom: 1rem;">Performance Breakdown</h3>
          
          <div class="mb-3">
            <div class="flex justify-between mb-1">
              <span class="text-small text-bold">Technical Knowledge</span>
              <span class="text-small text-bold">92/100</span>
            </div>
            <div style="background: #f0f0f0; height: 8px; border-radius: 4px; overflow: hidden;">
              <div style="background: #16a34a; height: 100%; width: 92%;"></div>
            </div>
          </div>

          <div class="mb-3">
            <div class="flex justify-between mb-1">
              <span class="text-small text-bold">Problem Solving</span>
              <span class="text-small text-bold">90/100</span>
            </div>
            <div style="background: #f0f0f0; height: 8px; border-radius: 4px; overflow: hidden;">
              <div style="background: #16a34a; height: 100%; width: 90%;"></div>
            </div>
          </div>

          <div class="mb-3">
            <div class="flex justify-between mb-1">
              <span class="text-small text-bold">Communication</span>
              <span class="text-small text-bold">85/100</span>
            </div>
            <div style="background: #f0f0f0; height: 8px; border-radius: 4px; overflow: hidden;">
              <div style="background: #16a34a; height: 100%; width: 85%;"></div>
            </div>
          </div>

          <div class="mb-3">
            <div class="flex justify-between mb-1">
              <span class="text-small text-bold">System Design</span>
              <span class="text-small text-bold">87/100</span>
            </div>
            <div style="background: #f0f0f0; height: 8px; border-radius: 4px; overflow: hidden;">
              <div style="background: #16a34a; height: 100%; width: 87%;"></div>
            </div>
          </div>

          <!-- Key Highlights -->
          <h3 style="font-size: 1rem; margin-bottom: 0.75rem; margin-top: 1.5rem;">Key Highlights</h3>
          <ul style="padding-left: 1.5rem; margin: 0; color: #555;">
            <li style="margin-bottom: 0.5rem;">Provided well-structured approach to scaling microservices</li>
            <li style="margin-bottom: 0.5rem;">Demonstrated practical experience with Kubernetes and cloud deployment</li>
            <li style="margin-bottom: 0.5rem;">Asked clarifying questions before solving problems</li>
            <li style="margin-bottom: 0.5rem;">Showed awareness of trade-offs in technical decisions</li>
          </ul>

          <div class="mt-4">
            <button class="btn btn-outline btn-small" onclick="viewInterviewTranscript()">
              üìù View Full Interview Transcript
            </button>
          </div>
        </div>
      </div>

      <!-- Cover Letter Card (if provided) -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Cover Letter</h2>
        </div>
        <div class="card-body">
          <p style="line-height: 1.6;">
            I am excited to apply for the Senior Software Engineer position at your company. With over 7 years of 
            experience building scalable distributed systems, I believe I would be a strong addition to your team.
          </p>
          <p style="line-height: 1.6;">
            In my current role at Google, I've led the development of microservices that handle millions of requests 
            per day, using Python, Go, and Kubernetes. I'm particularly interested in your work on cloud infrastructure 
            and would love to contribute to building robust, high-performance systems.
          </p>
          <p style="line-height: 1.6;">
            I'm impressed by your company's commitment to engineering excellence and innovation, and I'm eager to 
            bring my expertise in distributed systems to help solve challenging technical problems.
          </p>
        </div>
      </div>

      <!-- Action Buttons (Bottom) -->
      <div class="card" style="background: #f9f9f9;">
        <h3 style="font-size: 1rem; margin-bottom: 1rem;">Take Action</h3>
        <div class="flex gap-2 flex-wrap">
          <button class="btn btn-success btn-large" onclick="shortlistApplicant()">
            ‚úì Shortlist for Next Round
          </button>
          <button class="btn btn-danger btn-large" onclick="rejectApplicant()">
            ‚úï Reject Application
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p class="footer-text">&copy; 2024 AI Hiring Platform. All rights reserved.</p>
      <ul class="footer-links">
        <li><a href="privacy.html" class="footer-link">Privacy Policy</a></li>
      </ul>
    </div>
  </footer>

  <!-- Confirmation Modal -->
  <div id="confirmModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Confirm Action</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p id="modalMessage"></p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" id="modalConfirmBtn" onclick="confirmAction()">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    // Check authentication
    const token = localStorage.getItem('companyToken');
    if (!token) {
      window.location.href = 'company-login.html';
    }

    let currentAction = null;

    // Logout function
    function logout() {
      localStorage.removeItem('companyToken');
      localStorage.removeItem('userType');
      window.location.href = 'landing.html';
    }

    // Shortlist applicant
    function shortlistApplicant() {
      currentAction = 'shortlist';
      document.getElementById('modalTitle').textContent = 'Shortlist Candidate';
      document.getElementById('modalMessage').textContent = 'Are you sure you want to shortlist this candidate for the next round?';
      document.getElementById('confirmModal').classList.add('active');
    }

    // Reject applicant
    function rejectApplicant() {
      currentAction = 'reject';
      document.getElementById('modalTitle').textContent = 'Reject Application';
      document.getElementById('modalMessage').textContent = 'Are you sure you want to reject this application? This action cannot be undone.';
      document.getElementById('confirmModal').classList.add('active');
    }

    // Close modal
    function closeModal() {
      document.getElementById('confirmModal').classList.remove('active');
      currentAction = null;
    }

    // Confirm action
    async function confirmAction() {
      const successDiv = document.getElementById('successMessage');
      const errorDiv = document.getElementById('errorMessage');
      
      closeModal();
      
      try {
        // TODO: Replace with actual backend endpoint
        const endpoint = currentAction === 'shortlist' 
          ? '/api/company/applicants/shortlist' 
          : '/api/company/applicants/reject';
        
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`,
          },
          body: JSON.stringify({ applicantId: 'applicant-123' }),
        });
        
        if (response.ok) {
          const message = currentAction === 'shortlist' 
            ? 'Candidate shortlisted successfully!' 
            : 'Application rejected.';
          successDiv.textContent = message;
          successDiv.classList.remove('hidden');
          window.scrollTo(0, 0);
          
          // Update status badge
          setTimeout(() => {
            window.location.reload();
          }, 1500);
        }
      } catch (error) {
        console.error('Action error:', error);
        errorDiv.textContent = 'An error occurred. Please try again.';
        errorDiv.classList.remove('hidden');
        window.scrollTo(0, 0);
      }
    }

    // Download resume
    function downloadResume() {
      // TODO: Implement download functionality
      alert('Resume download will be implemented');
    }

    // Contact candidate
    function contactCandidate() {
      window.location.href = 'mailto:sarah.johnson@email.com';
    }

    // View interview transcript
    function viewInterviewTranscript() {
      // TODO: Open modal or new page with transcript
      alert('Interview transcript view will be implemented');
    }

    // Load applicant details
    async function loadApplicantDetails() {
      const urlParams = new URLSearchParams(window.location.search);
      const applicantId = urlParams.get('id');
      
      if (!applicantId) return;
      
      try {
        const response = await fetch(`/api/company/applicants/${applicantId}`, {
          headers: {
            'Authorization': `Bearer ${token}`,
          },
        });
        
        const data = await response.json();
        
        if (response.ok && data.applicant) {
          // TODO: Populate page with applicant data
          console.log('Applicant data:', data.applicant);
        }
      } catch (error) {
        console.error('Error loading applicant details:', error);
      }
    }

    // Load on page load
    // loadApplicantDetails(); // Uncomment when backend is ready
  </script>
</body>
</html>
